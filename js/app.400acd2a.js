(function(e){function t(t){for(var i,r,o=t[0],l=t[1],u=t[2],d=0,m=[];d<o.length;d++)r=o[d],Object.prototype.hasOwnProperty.call(s,r)&&s[r]&&m.push(s[r][0]),s[r]=0;for(i in l)Object.prototype.hasOwnProperty.call(l,i)&&(e[i]=l[i]);c&&c(t);while(m.length)m.shift()();return a.push.apply(a,u||[]),n()}function n(){for(var e,t=0;t<a.length;t++){for(var n=a[t],i=!0,o=1;o<n.length;o++){var l=n[o];0!==s[l]&&(i=!1)}i&&(a.splice(t--,1),e=r(r.s=n[0]))}return e}var i={},s={app:0},a=[];function r(t){if(i[t])return i[t].exports;var n=i[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,r),n.l=!0,n.exports}r.m=e,r.c=i,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)r.d(n,i,function(t){return e[t]}.bind(null,i));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="/minecolonies-companion/";var o=window["webpackJsonp"]=window["webpackJsonp"]||[],l=o.push.bind(o);o.push=t,o=o.slice();for(var u=0;u<o.length;u++)t(o[u]);var c=l;a.push([0,"chunk-vendors"]),n()})({0:function(e,t,n){e.exports=n("56d7")},"034f":function(e,t,n){"use strict";var i=n("85ec"),s=n.n(i);s.a},"0626":function(e,t,n){"use strict";var i=n("bfd2"),s=n.n(i);s.a},"0747":function(e,t,n){},"22d7":function(e,t,n){"use strict";var i=n("be87"),s=n.n(i);s.a},"56d7":function(e,t,n){"use strict";n.r(t);n("e260"),n("e6cf"),n("cca6"),n("a79d");var i=n("2b0e"),s=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:"app"}},[n("section",[n("h2",[e._v("Citizens")]),n("p",{directives:[{name:"show",rawName:"v-show",value:e.citizens.length<1,expression:"citizens.length < 1"}]},[e._v("Start by adding a citizen, click on the button below.")]),n("CitizenList",{directives:[{name:"show",rawName:"v-show",value:e.citizens.length>0,expression:"citizens.length > 0"}],attrs:{items:e.citizens}}),n("button",{attrs:{type:"button"},on:{click:function(t){return t.preventDefault(),e.showNewCitizenForm(t)}}},[e._v("Add a citizen")])],1),e.isNewCitizenFormVisible?n("NewCitizenForm",{on:{close:function(t){e.isNewCitizenFormVisible=!1}}}):e._e(),n("section",[n("h2",[e._v("Houses")]),n("p",{directives:[{name:"show",rawName:"v-show",value:e.houses.length<1,expression:"houses.length < 1"}]},[e._v("Start by adding a house, click on the button below.")]),n("HouseList",{directives:[{name:"show",rawName:"v-show",value:e.houses.length>0,expression:"houses.length > 0"}],attrs:{items:e.houses}}),n("button",{attrs:{type:"button"},on:{click:function(t){t.preventDefault(),e.isNewHouseFormVisible=!0}}},[e._v("Add a house")])],1),e.isNewHouseFormVisible?n("NewHouseForm",{on:{close:function(t){e.isNewHouseFormVisible=!1}}}):e._e()],1)},a=[],r=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("section",{staticClass:"citizen-list"},[e._m(0),e._l(e.items,(function(t){return n("CitizenListItem",{key:t.id,attrs:{citizen:t},on:{edit:e.onEdit,assignJob:e.onAssignJob}})}))],2),null!==e.editedCitizen?n("EditCitizenForm",{attrs:{citizen:e.editedCitizen},on:{close:function(t){e.editedCitizen=null}}}):e._e(),null!==e.assigningCitizen?n("JobAssignmentModal",{attrs:{"selected-citizen":e.assigningCitizen,citizens:e.items},on:{close:function(t){e.assigningCitizen=null}}}):e._e()],1)},o=[function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("ul",{staticClass:"citizen-list-header"},[n("li",{staticClass:"citizen-list-header-item mod-name"},[e._v("Citizen")]),n("li",{staticClass:"citizen-list-header-item mod-job"},[e._v("Job")]),n("li",{staticClass:"citizen-list-header-item mod-house"},[e._v("House")]),n("li",{staticClass:"citizen-list-header-item mod-actions"})])}],l=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("article",{staticClass:"citizen-list-item"},[n("p",{staticClass:"citizen-list-item-column mod-name"},[e._v(e._s(e.citizen.name))]),n("p",{staticClass:"citizen-list-item-column mod-job"},[e._v(e._s(e.jobTitle))]),n("p",{staticClass:"citizen-list-item-column mod-house"},[e._v(e._s(e.houseName))]),n("div",{staticClass:"citizen-list-item-column mod-actions"},[n("button",{staticClass:"citizen-list-item-action",attrs:{type:"button"},on:{click:function(t){return t.preventDefault(),e.$emit("assignJob",e.citizen)}}},[e._v("Job")]),n("button",{staticClass:"citizen-list-item-action",attrs:{type:"button"},on:{click:function(t){return t.preventDefault(),e.$emit("edit",e.citizen)}}},[e._v("Edit")]),n("button",{staticClass:"citizen-list-item-action",attrs:{type:"button"},on:{click:function(t){return t.preventDefault(),e.handleDelete(t)}}},[e._v("Delete")])])])},u=[],c=(n("b0c0"),n("96cf"),n("1da1")),d=n("d4ec"),m=n("bee2"),h=n("ade3"),f=function(){function e(t,n,i){Object(d["a"])(this,e),Object(h["a"])(this,"id",void 0),Object(h["a"])(this,"name",void 0),Object(h["a"])(this,"job",null),Object(h["a"])(this,"skills",{}),this.id=t,this.name=n,this.skills=i}return Object(m["a"])(e,[{key:"toJson",value:function(){return{name:this.name,job:this.job,skills:this.skills}}}],[{key:"fromJson",value:function(t){var n=new e(t.id,t.name,t.skills);return Object.prototype.hasOwnProperty.call(t,"job")&&null!==t.job&&(n.job=t.job),n}}]),e}(),p=function(){function e(t,n,i){Object(d["a"])(this,e),Object(h["a"])(this,"id",void 0),Object(h["a"])(this,"name",void 0),Object(h["a"])(this,"bedCount",void 0),Object(h["a"])(this,"inhabitants",[]),this.id=t,this.name=n,this.bedCount=i}return Object(m["a"])(e,[{key:"toJson",value:function(){return{name:this.name,beds:this.bedCount,inhabitants:this.inhabitants}}}],[{key:"fromJson",value:function(t){var n=new e(t.id,t.name,t.beds);return Object.prototype.hasOwnProperty.call(t,"inhabitants")&&Array.isArray(t.inhabitants)&&(n.inhabitants=t.inhabitants),n}}]),e}(),b=(n("13d5"),n("dca8"),Object.freeze([{id:"baker",name:"Baker",skills:{primary:["knowledge"],secondary:["dexterity"]}},{id:"blacksmith",name:"Blacksmith",skills:{primary:["strength"],secondary:["focus"]}},{id:"builder",name:"Builder",skills:{primary:["adaptability"],secondary:["athletics"]}},{id:"chickenHerder",name:"Chicken Herder",skills:{primary:["adaptability"],secondary:["agility"]}},{id:"composter",name:"Composter",skills:{primary:["stamina"],secondary:["athletics"]}},{id:"cook",name:"Cook",skills:{primary:["adaptability"],secondary:["knowledge"]}},{id:"cowboy",name:"Cowboy",skills:{primary:["athletics"],secondary:["stamina"]}},{id:"crusher",name:"Crusher",skills:{primary:["stamina"],secondary:["strength"]}},{id:"deliveryman",name:"Deliveryman",skills:{primary:["agility"],secondary:["adaptability"]}},{id:"enchanter",name:"Enchanter",skills:{primary:["mana"],secondary:["knowledge"]}},{id:"farmer",name:"Farmer",skills:{primary:["stamina"],secondary:["athletics"]}},{id:"fisherman",name:"Fisherman",skills:{primary:["focus"],secondary:["agility"]}},{id:"florist",name:"Florist",skills:{primary:["dexterity"],secondary:["agility"]}},{id:"guard",name:"Guard",skills:{primary:["adaptability"],secondary:["stamina"]}},{id:"healer",name:"Healer",skills:{primary:["mana"],secondary:["knowledge"]}},{id:"libraryStudent",name:"Library Student",skills:{primary:["intelligence"],secondary:[]}},{id:"lumberjack",name:"Lumberjack",skills:{primary:["strength"],secondary:["focus"]}},{id:"miller",name:"Woodworker (Miller)",skills:{primary:["knowledge"],secondary:["dexterity"]}},{id:"miner",name:"Miner",skills:{primary:["strength"],secondary:["stamina"]}},{id:"ranger",name:"Ranger",skills:{primary:["agility"],secondary:["adaptability"]}},{id:"shepherd",name:"Shepherd",skills:{primary:["focus"],secondary:["strength"]}},{id:"Sifter",name:"Sifter",skills:{primary:["focus"],secondary:["strength"]}},{id:"smelter",name:"Smelter",skills:{primary:["athletics"],secondary:["strength"]}},{id:"stonemason",name:"StoneMason",skills:{primary:["creativity"],secondary:["dexterity"]}},{id:"stoneSmelter",name:"Stone Smelter",skills:{primary:["athletics"],secondary:["dexterity"]}},{id:"swineHerder",name:"Swine Herder",skills:{primary:["strength"],secondary:["athletics"]}},{id:"universityStudent",name:"University Student",skills:{primary:["knowledge"],secondary:["mana"]}},{id:"knight",name:"Knight",skills:{primary:["adaptability"],secondary:["stamina"]}},{id:"teacher",name:"Teacher",skills:{primary:["intelligence","knowledge"],secondary:["mana"]}},{id:"pupil",name:"Pupil",skills:{primary:["intelligence","knowledge"],secondary:["mana"]}},{id:"plant",name:"Planter",skills:{primary:["agility"],secondary:["dexterity"]}},{id:"mechanic",name:"Mechanic",skills:{primary:["knowledge"],secondary:["agility"]}},{id:"glassblower",name:"Glassblower",skills:{primary:["creativity"],secondary:["focus"]}}])),v=b;function y(e){return b.reduce((function(t,n){return n.id===e?n:t}),null)}function k(e){return null!==y(e)}var g={name:"CitizenListItem",props:{citizen:{type:f,required:!0}},computed:{jobTitle:function(){if(!this.citizen.job)return"Unemployed";var e=y(this.citizen.job);return e?e.name:"Unemployed"},house:function(){return this.$store.getters["houses/findByInhabitant"](this.citizen.id)},houseName:function(){return this.house instanceof p?this.house.name:"Homeless"}},methods:{handleDelete:function(){var e=this;return Object(c["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(confirm("Are you sure you want to delete ".concat(e.citizen.name,"?"))){t.next=2;break}return t.abrupt("return");case 2:return t.next=4,e.$store.dispatch("citizens/remove",e.citizen.id);case 4:if(!(e.house instanceof p)){t.next=7;break}return t.next=7,e.$store.dispatch("houses/removeInhabitant",{houseId:e.house.id,inhabitantId:e.citizen.id});case 7:case"end":return t.stop()}}),t)})))()}}},w=g,_=(n("f3ff"),n("2877")),z=Object(_["a"])(w,l,u,!1,null,"91fea456",null),C=z.exports,S=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("Modal",{on:{close:e.closeForm},scopedSlots:e._u([{key:"header",fn:function(){return[e._v("Edit citizen: "+e._s(e.citizen.name))]},proxy:!0},{key:"actions",fn:function(){return[n("button",{staticClass:"modal-action-list-item",attrs:{type:"button"},on:{click:function(t){return t.preventDefault(),e.closeForm(t)}}},[e._v("Cancel")]),n("button",{staticClass:"modal-action-list-item",attrs:{type:"button"},on:{click:function(t){return t.preventDefault(),e.handleSubmit(t)}}},[e._v("Save changes")])]},proxy:!0}])},[n("form",{on:{submit:function(t){return t.preventDefault(),e.handleSubmit(t)}}},[n("ul",[n("li",[n("label",{attrs:{for:"citizen_name"}},[e._v("Name")]),n("input",{directives:[{name:"model",rawName:"v-model",value:e.newName,expression:"newName"},{name:"focus",rawName:"v-focus"}],attrs:{name:"name",id:"citizen_name",type:"text"},domProps:{value:e.newName},on:{input:function(t){t.target.composing||(e.newName=t.target.value)}}})]),n("li",[n("label",{attrs:{for:"citizen_house"}},[e._v("House")]),n("select",{directives:[{name:"model",rawName:"v-model",value:e.newHouse,expression:"newHouse"}],attrs:{name:"house",id:"citizen_house"},on:{change:function(t){var n=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){var t="_value"in e?e._value:e.value;return t}));e.newHouse=t.target.multiple?n:n[0]}}},[n("option",{attrs:{value:""}},[e._v("Homeless")]),e._l(e.availableHouses,(function(t){return n("option",{key:t.id,attrs:{disabled:t.bedCount<=t.inhabitants.length},domProps:{value:t.id}},[e._v(" "+e._s(t.name)+" ("+e._s(t.inhabitants.length)+" / "+e._s(t.bedCount)+") ")])}))],2)]),n("li",[e._v("Skills: "),n("ul",e._l(e.availableSkills,(function(t){return n("li",{key:t.id},[n("label",{attrs:{for:"citizen_skill_"+t.id}},[e._v(e._s(t.name))]),n("input",{directives:[{name:"model",rawName:"v-model",value:e.newSkills[t.id],expression:"newSkills[skill.id]"}],attrs:{name:"skills["+t.id+"]",id:"citizen_skill_"+t.id,type:"number",min:"1"},domProps:{value:e.newSkills[t.id]},on:{input:function(n){n.target.composing||e.$set(e.newSkills,t.id,n.target.value)}}})])})),0)])]),n("button",{staticStyle:{display:"none"},attrs:{type:"submit"}})])])},x=[],j=(n("498a"),Object.freeze([{id:"athletics",name:"Athletics"},{id:"dexterity",name:"Dexterity"},{id:"strength",name:"Strength"},{id:"agility",name:"Agility"},{id:"stamina",name:"Stamina"},{id:"mana",name:"Mana"},{id:"adaptability",name:"Adaptability"},{id:"focus",name:"Focus"},{id:"creativity",name:"Creativity"},{id:"knowledge",name:"Knowledge"},{id:"intelligence",name:"Intelligence"}])),O=j;function I(e){return j.reduce((function(t,n){return n.id===e?n:t}),null)}var H=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("transition",{attrs:{name:"modal"}},[n("article",{staticClass:"modal"},[n("div",{staticClass:"modal-overlay",on:{click:function(t){return t.preventDefault(),e.$emit("close")},keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"escape",void 0,t.key,void 0)?null:e.$emit("close")}}},[n("div",{staticClass:"modal-container",on:{click:function(e){e.stopPropagation()}}},[n("h2",{staticClass:"modal-title"},[e._t("header",[e._v("Default modal header")])],2),n("div",{staticClass:"modal-body"},[e._t("default",[n("p",[e._v("Default modal content")])])],2),n("div",{staticClass:"modal-action-list"},[e._t("actions",[n("button",{staticClass:"modal-action-list-item",attrs:{type:"button"},on:{click:function(t){return t.preventDefault(),e.$emit("close")}}},[e._v("Close")])])],2)])])])])},N=[],$={name:"Modal"},F=$,E=(n("22d7"),Object(_["a"])(F,H,N,!1,null,null,null)),P=E.exports,J={name:"EditCitizenForm",components:{Modal:P},data:function(){var e=this.$store.getters["houses/findByInhabitant"](this.citizen.id);return{availableSkills:O,availableHouses:this.$store.getters["houses/getSorted"],currentHouse:e||null,newName:this.citizen.name,newHouse:e?e.id:"",newSkills:Object.assign({},this.citizen.skills)}},props:{citizen:{type:f,required:!0}},methods:{handleSubmit:function(){var e=this;return Object(c["a"])(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(n=e.newName&&e.newName.trim(),n){t.next=3;break}return t.abrupt("return");case 3:return t.next=5,e.$store.dispatch("citizens/edit",{citizenId:e.citizen.id,name:n,skills:e.newSkills});case 5:if(""===e.newHouse){t.next=10;break}return t.next=8,e.$store.dispatch("houses/assignInhabitant",{houseId:e.newHouse,inhabitantId:e.citizen.id});case 8:t.next=12;break;case 10:return t.next=12,e.$store.dispatch("houses/removeInhabitant",{houseId:e.currentHouse.id,inhabitantId:e.citizen.id});case 12:e.closeForm();case 13:case"end":return t.stop()}}),t)})))()},closeForm:function(){this.$emit("close")}}},D=J,A=Object(_["a"])(D,S,x,!1,null,"762bb5a4",null),B=A.exports,L=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("Modal",{class:"mod-fullpage",on:{close:e.closeForm},scopedSlots:e._u([{key:"header",fn:function(){return[e._v("Assignment: "+e._s(e.selectedCitizen.name))]},proxy:!0},{key:"actions",fn:function(){return[n("button",{staticClass:"modal-action-list-item",attrs:{type:"button"},on:{click:function(t){return t.preventDefault(),e.closeForm(t)}}},[e._v("Close")])]},proxy:!0}])},[n("table",{staticClass:"job-list"},[n("thead",[n("tr",[n("th",[e._v("Job")]),n("th",[e._v("Skills")]),n("th",[e._v("Score")]),n("th",[e._v("Other workers")]),n("th",[e._v("Actions")])])]),n("tbody",e._l(e.citizenJobs,(function(t){return n("tr",{key:t.id,class:{"current-job":e.selectedCitizen.job===t.id}},[n("th",{staticStyle:{"text-align":"left"}},[e._v(e._s(t.name))]),n("td",[e._l(t.primarySkills,(function(t){return n("div",{key:t},[e._v(e._s(e.findSkillById(t).name))])})),e._l(t.secondarySkills,(function(t){return n("div",{key:t},[e._v(e._s(e.findSkillById(t).name))])}))],2),n("td",[e._v(e._s(t.getScore()))]),n("td",e._l(e.getWorkerForJob(e.findJobById(t.id)),(function(t){return n("div",{key:t.id},[e._v(" "+e._s(t.name)+": "+e._s(t.job.getScore())+" ")])})),0),n("td",[n("button",{attrs:{type:"button"},on:{click:function(n){return n.preventDefault(),e.assign(e.selectedCitizen.id,t.id)}}},[e._v("Assign")])])])})),0)])])},M=[],R=(n("4de4"),n("d81d"),n("4160"),n("159b"),function(){function e(t,n,i,s){Object(d["a"])(this,e),Object(h["a"])(this,"id",void 0),Object(h["a"])(this,"name",void 0),Object(h["a"])(this,"primarySkills",void 0),Object(h["a"])(this,"secondarySkills",void 0),Object(h["a"])(this,"primarySkillLevels",void 0),Object(h["a"])(this,"secondarySkillLevels",void 0),this.id=t,this.name=n,this.primarySkills=i,this.secondarySkills=s}return Object(m["a"])(e,[{key:"setCitizenLevels",value:function(e){var t=this;this.primarySkillLevels={},this.primarySkills.forEach((function(n){if(!Object.prototype.hasOwnProperty.call(e,n))throw new Error("Citizen skills object does not contain required skill: ".concat(n));t.primarySkillLevels[n]=e[n]})),this.secondarySkills&&(this.secondarySkillLevels={},this.secondarySkills.forEach((function(n){if(!Object.prototype.hasOwnProperty.call(e,n))throw new Error("Citizen skills object does not contain required skill: ".concat(n));t.secondarySkillLevels[n]=e[n]})))}},{key:"getScore",value:function(){var e=0;for(var t in this.primarySkillLevels)Object.prototype.hasOwnProperty.call(this.primarySkillLevels,t)&&(e+=2*this.primarySkillLevels[t]);for(var n in this.secondarySkillLevels)Object.prototype.hasOwnProperty.call(this.secondarySkillLevels,n)&&(e+=parseInt(this.secondarySkillLevels[n]));return e}}],[{key:"fromJob",value:function(t){return new e(t.id,t.name,t.skills.primary,t.skills.secondary)}},{key:"compareByScore",value:function(e,t){return e.getScore()===t.getScore()?0:e.getScore()<t.getScore()}}]),e}()),q={name:"AssignmentModal",components:{Modal:P},props:{selectedCitizen:{type:f,required:!0},citizens:{type:Array,required:!0}},data:function(){var e=this;return{citizenJobs:v.map((function(t){var n=R.fromJob(t);return n.setCitizenLevels(e.selectedCitizen.skills),n})).sort(R.compareByScore)}},computed:{otherCitizens:function(){var e=this;return this.citizens.filter((function(t){return t.id!==e.selectedCitizen.id}))}},methods:{closeForm:function(){this.$emit("close")},findJobById:function(e){return y(e)},findSkillById:function(e){return I(e)},getWorkerForJob:function(e){return this.otherCitizens.filter((function(t){return t.job===e.id})).map((function(t){var n=R.fromJob(e);return n.setCitizenLevels(t.skills),{id:t.id,name:t.name,job:n}}))},assign:function(e,t){var n=this;return Object(c["a"])(regeneratorRuntime.mark((function i(){return regeneratorRuntime.wrap((function(i){while(1)switch(i.prev=i.next){case 0:return i.next=2,n.$store.dispatch("citizens/assignJob",{citizenId:e,jobId:t});case 2:case"end":return i.stop()}}),i)})))()}}},V=q,T=(n("0626"),Object(_["a"])(V,L,M,!1,null,"281c7d89",null)),U=T.exports,W={name:"CitizenList",components:{CitizenListItem:C,EditCitizenForm:B,JobAssignmentModal:U},data:function(){return{editedCitizen:null,assigningCitizen:null}},props:{items:{type:Array,required:!0}},methods:{onEdit:function(e){this.editedCitizen=e},onAssignJob:function(e){this.assigningCitizen=e}}},G=W,K=(n("c02b"),Object(_["a"])(G,r,o,!1,null,"3c0ad4b4",null)),Q=K.exports,X=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("Modal",{on:{close:e.closeForm},scopedSlots:e._u([{key:"header",fn:function(){return[e._v("New citizen")]},proxy:!0},{key:"actions",fn:function(){return[n("button",{staticClass:"modal-action-list-item",attrs:{type:"button"},on:{click:function(t){return t.preventDefault(),e.closeForm(t)}}},[e._v("Cancel")]),n("button",{staticClass:"modal-action-list-item",attrs:{type:"button"},on:{click:function(t){return t.preventDefault(),e.handleSubmit(t)}}},[e._v("Create citizen")])]},proxy:!0}])},[n("form",{on:{submit:function(t){return t.preventDefault(),e.handleSubmit(t)}}},[n("ul",[n("li",[n("label",{attrs:{for:"citizen_name"}},[e._v("Name")]),n("input",{directives:[{name:"model",rawName:"v-model",value:e.newCitizen.name,expression:"newCitizen.name"},{name:"focus",rawName:"v-focus"}],attrs:{name:"name",id:"citizen_name",type:"text"},domProps:{value:e.newCitizen.name},on:{input:function(t){t.target.composing||e.$set(e.newCitizen,"name",t.target.value)}}})]),n("li",[n("label",{attrs:{for:"citizen_house"}},[e._v("House")]),n("select",{directives:[{name:"model",rawName:"v-model",value:e.newCitizen.house,expression:"newCitizen.house"}],attrs:{name:"house",id:"citizen_house"},on:{change:function(t){var n=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){var t="_value"in e?e._value:e.value;return t}));e.$set(e.newCitizen,"house",t.target.multiple?n:n[0])}}},[n("option",{attrs:{value:""}},[e._v("Homeless")]),e._l(e.availableHouses,(function(t){return n("option",{key:t.id,attrs:{disabled:t.bedCount<=t.inhabitants.length},domProps:{value:t.id}},[e._v(" "+e._s(t.name)+" ("+e._s(t.inhabitants.length)+" / "+e._s(t.bedCount)+") ")])}))],2)]),n("li",[e._v("Skills: "),n("ul",e._l(e.availableSkills,(function(t){return n("li",{key:t.id},[n("label",{attrs:{for:"citizen_skill_"+t.id}},[e._v(e._s(t.name))]),n("input",{directives:[{name:"model",rawName:"v-model",value:e.newCitizen.skills[t.id],expression:"newCitizen.skills[skill.id]"}],attrs:{name:"skills["+t.id+"]",id:"citizen_skill_"+t.id,type:"number",min:"1"},domProps:{value:e.newCitizen.skills[t.id]},on:{input:function(n){n.target.composing||e.$set(e.newCitizen.skills,t.id,n.target.value)}}})])})),0)])]),n("button",{staticStyle:{display:"none"},attrs:{type:"submit"}})])])},Y=[],Z={name:"NewCitizenForm",components:{Modal:P},data:function(){return{newCitizen:this.getInitialState(),availableSkills:O,availableHouses:this.$store.getters["houses/getSorted"]}},methods:{handleSubmit:function(){var e=this;return Object(c["a"])(regeneratorRuntime.mark((function t(){var n,i;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(n=e.newCitizen.name&&e.newCitizen.name.trim(),n){t.next=3;break}return t.abrupt("return");case 3:return t.next=5,e.$store.dispatch("citizens/add",{name:e.newCitizen.name,skills:e.newCitizen.skills});case 5:if(i=t.sent,""===e.newCitizen.house){t.next=9;break}return t.next=9,e.$store.dispatch("houses/assignInhabitant",{houseId:e.newCitizen.house,inhabitantId:i.id});case 9:e.closeForm();case 10:case"end":return t.stop()}}),t)})))()},getInitialState:function(){var e={name:"",house:"",skills:{}};return O.forEach((function(t){e.skills[t.id]=1})),e},closeForm:function(){this.newCitizen=this.getInitialState(),this.$emit("close")}}},ee=Z,te=Object(_["a"])(ee,X,Y,!1,null,"b0c15a2a",null),ne=te.exports,ie=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("Modal",{on:{close:e.closeForm},scopedSlots:e._u([{key:"header",fn:function(){return[e._v("New house")]},proxy:!0},{key:"actions",fn:function(){return[n("button",{staticClass:"modal-action-list-item",attrs:{type:"button"},on:{click:function(t){return t.preventDefault(),e.closeForm(t)}}},[e._v("Cancel")]),n("button",{staticClass:"modal-action-list-item",attrs:{type:"button"},on:{click:function(t){return t.preventDefault(),e.handleSubmit(t)}}},[e._v("Create house")])]},proxy:!0}])},[n("form",{on:{submit:function(t){return t.preventDefault(),e.handleSubmit(t)}}},[n("ul",[n("li",[n("label",{attrs:{for:"house_name"}},[e._v("Name")]),n("input",{directives:[{name:"model",rawName:"v-model",value:e.newHouse.name,expression:"newHouse.name"},{name:"focus",rawName:"v-focus"}],attrs:{name:"name",id:"house_name",type:"text"},domProps:{value:e.newHouse.name},on:{input:function(t){t.target.composing||e.$set(e.newHouse,"name",t.target.value)}}})]),n("li",[n("label",{attrs:{for:"house_beds"}},[e._v("Beds")]),n("input",{directives:[{name:"model",rawName:"v-model",value:e.newHouse.beds,expression:"newHouse.beds"}],attrs:{name:"beds",id:"house_beds",type:"number",min:"1"},domProps:{value:e.newHouse.beds},on:{input:function(t){t.target.composing||e.$set(e.newHouse,"beds",t.target.value)}}})])]),n("button",{staticStyle:{display:"none"},attrs:{type:"submit"}})])])},se=[],ae={name:"NewHouseForm",components:{Modal:P},data:function(){return{newHouse:this.getInitialState()}},methods:{handleSubmit:function(){var e=this;return Object(c["a"])(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(n=e.newHouse.name&&e.newHouse.name.trim(),n){t.next=3;break}return t.abrupt("return");case 3:return t.next=5,e.$store.dispatch("houses/add",{name:e.newHouse.name,beds:e.newHouse.beds});case 5:e.closeForm();case 6:case"end":return t.stop()}}),t)})))()},getInitialState:function(){return{name:"",beds:1}},closeForm:function(){this.newHouse=this.getInitialState(),this.$emit("close")}}},re=ae,oe=Object(_["a"])(re,ie,se,!1,null,"1d920fa5",null),le=oe.exports,ue=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("section",{staticClass:"house-list"},[e._m(0),e._l(e.items,(function(t){return n("HouseListItem",{key:t.id,attrs:{house:t},on:{edit:e.onEdit}})}))],2),null!==e.editedHouse?n("EditHouseForm",{attrs:{house:e.editedHouse},on:{close:function(t){e.editedHouse=null}}}):e._e()],1)},ce=[function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("ul",{staticClass:"house-list-header"},[n("li",{staticClass:"house-list-header-item mod-name"},[e._v("Name")]),n("li",{staticClass:"house-list-header-item mod-job"},[e._v("Beds")]),n("li",{staticClass:"house-list-header-item mod-actions"})])}],de=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("article",{staticClass:"house-list-item"},[n("p",{staticClass:"house-list-item-column mod-name"},[e._v(e._s(e.house.name))]),n("p",{staticClass:"house-list-item-column mod-beds"},[e._v(e._s(e.house.inhabitants.length)+" / "+e._s(e.house.bedCount))]),n("div",{staticClass:"house-list-item-column mod-actions"},[n("button",{staticClass:"house-list-item-action",attrs:{type:"button"},on:{click:function(t){return t.preventDefault(),e.$emit("edit",e.house)}}},[e._v("Edit")]),n("button",{staticClass:"house-list-item-action",attrs:{type:"button"},on:{click:function(t){return t.preventDefault(),e.handleDelete(t)}}},[e._v("Delete")])])])},me=[],he={name:"HouseListItem",props:{house:{type:p,required:!0}},methods:{handleDelete:function(){var e=this;return Object(c["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(confirm('Are you sure you want to delete house "'.concat(e.house.name,'"?'))){t.next=2;break}return t.abrupt("return");case 2:return t.next=4,e.$store.dispatch("houses/remove",e.house.id);case 4:case"end":return t.stop()}}),t)})))()}}},fe=he,pe=(n("ac87"),Object(_["a"])(fe,de,me,!1,null,"5adab81e",null)),be=pe.exports,ve=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("Modal",{on:{close:e.closeForm},scopedSlots:e._u([{key:"header",fn:function(){return[e._v("Edit house: "+e._s(e.house.name))]},proxy:!0},{key:"actions",fn:function(){return[n("button",{staticClass:"modal-action-list-item",attrs:{type:"button"},on:{click:function(t){return t.preventDefault(),e.closeForm()}}},[e._v("Cancel")]),n("button",{staticClass:"modal-action-list-item",attrs:{type:"button"},on:{click:function(t){return t.preventDefault(),e.handleSubmit(t)}}},[e._v("Save changes")])]},proxy:!0}])},[n("form",{on:{submit:function(t){return t.preventDefault(),e.handleSubmit(t)}}},[n("ul",[n("li",[n("label",{attrs:{for:"house_name"}},[e._v("Name")]),n("input",{directives:[{name:"model",rawName:"v-model",value:e.name,expression:"name"},{name:"focus",rawName:"v-focus"}],attrs:{name:"name",id:"house_name",type:"text"},domProps:{value:e.name},on:{input:function(t){t.target.composing||(e.name=t.target.value)}}})]),n("li",[n("label",{attrs:{for:"house_beds"}},[e._v("Beds")]),n("input",{directives:[{name:"model",rawName:"v-model",value:e.beds,expression:"beds"}],attrs:{name:"beds",id:"house_beds",type:"number",min:e.minimumBedValue},domProps:{value:e.beds},on:{input:function(t){t.target.composing||(e.beds=t.target.value)}}})])]),n("button",{staticStyle:{display:"none"},attrs:{type:"submit"}})])])},ye=[],ke={name:"EditHouseForm",components:{Modal:P},data:function(){return{name:this.house.name,beds:this.house.bedCount}},props:{house:{type:p,required:!0}},computed:{minimumBedValue:function(){return this.house.inhabitants.length>0?this.house.inhabitants.length:1}},methods:{handleSubmit:function(){var e=this;return Object(c["a"])(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(n=e.name&&e.name.trim(),n){t.next=3;break}return t.abrupt("return");case 3:return t.next=5,e.$store.dispatch("houses/edit",{houseId:e.house.id,name:e.name,beds:e.beds});case 5:e.closeForm();case 6:case"end":return t.stop()}}),t)})))()},closeForm:function(){this.name=null,this.beds=null,this.$emit("close")}}},ge=ke,we=Object(_["a"])(ge,ve,ye,!1,null,"2179ebb2",null),_e=we.exports,ze={name:"HouseList",components:{HouseListItem:be,EditHouseForm:_e},data:function(){return{editedHouse:null}},props:{items:{type:Array,required:!0}},methods:{onEdit:function(e){this.editedHouse=e}}},Ce=ze,Se=(n("70e2"),Object(_["a"])(Ce,ue,ce,!1,null,"221ab030",null)),xe=Se.exports,je={name:"App",components:{CitizenList:Q,NewCitizenForm:ne,NewHouseForm:le,HouseList:xe},data:function(){return{isNewCitizenFormVisible:!1,isNewHouseFormVisible:!1}},computed:{houses:function(){return this.$store.getters["houses/getSorted"]},citizens:function(){return this.$store.getters["citizens/sortByName"]}},methods:{showNewCitizenForm:function(){this.isNewCitizenFormVisible=!0}}},Oe=je,Ie=(n("034f"),Object(_["a"])(Oe,s,a,!1,null,null,null)),He=Ie.exports,Ne=n("2f62"),$e=(n("7db0"),n("c975"),n("a434"),n("a9e3"),n("8ba4"),n("d3b7"),n("15fd")),Fe=n("2909"),Ee="mc-citizen-list",Pe={uid:0,save:function(e){var t=e.map((function(e){return e.toJson()}));localStorage.setItem(Ee,JSON.stringify(t))},fetchAll:function(){var e=JSON.parse(localStorage.getItem(Ee)||"[]"),t=[];return e.forEach((function(e,n){e.id=n,t.push(f.fromJson(e))})),Pe.uid=t.length,t}},Je=Pe,De={namespaced:!0,state:function(){return{citizens:Je.fetchAll()}},getters:{findById:function(e){return function(t){return e.citizens.find((function(e){return e.id===t}))}},sortByName:function(e){return Object(Fe["a"])(e.citizens).sort((function(e,t){return e.name.localeCompare(t.name)}))}},mutations:{create:function(e,t){e.citizens.push(t),Je.save(e.citizens)},update:function(e,t){var n=t.citizen,i=t.payload,s=e.citizens.indexOf(n);Object.prototype.hasOwnProperty.call(i,"name")&&(n.name=i.name),Object.prototype.hasOwnProperty.call(i,"job")&&(n.job=i.job),Object.prototype.hasOwnProperty.call(i,"skills")&&(n.skills=i.skills),e.citizens[s]=n,Je.save(e.citizens)},deleteAtIndex:function(e,t){e.citizens.splice(t,1),Je.save(e.citizens)}},actions:{add:function(e,t){var n=t.name,i=t.job,s=t.skills;return new Promise((function(t){for(var a in s)Object.prototype.hasOwnProperty.call(s,a)&&(s[a]=parseInt(s[a]));var r=new f(Je.uid++,n,s);return r.job=i&&k(i)?i:null,e.commit("create",r),t(r)}))},remove:function(e,t){return new Promise((function(n,i){var s=e.getters.findById(t);if(null===s)return i("Could not find citizen in database");var a=e.state.citizens.indexOf(s);return e.commit("deleteAtIndex",a),n()}))},edit:function(e,t){var n=t.citizenId,i=Object($e["a"])(t,["citizenId"]);return new Promise((function(t,s){var a=e.getters.findById(n);if(null===a)return s("Could not find citizen in database");if(i.name&&(i.name=i.name.trim()),i.skills)for(var r in i.skills)Object.prototype.hasOwnProperty.call(i.skills,r)&&(i.skills[r]=parseInt(i.skills[r]));return Number.isInteger(i.job)&&(i.job=k(i.job)?i.job:null),e.commit("update",{citizen:a,payload:i}),t()}))},assignJob:function(e,t){var n=t.citizenId,i=t.jobId;return new Promise((function(t,s){var a=e.getters.findById(n);return null===a?s("Could not find citizen in database"):k(i)?(e.commit("update",{citizen:a,payload:{job:i}}),t()):s('Could not find job "'.concat(i,'"'))}))}}},Ae="mc-house-list",Be={uid:0,save:function(e){var t=e.map((function(e){return e.toJson()}));localStorage.setItem(Ae,JSON.stringify(t))},fetchAll:function(){var e=JSON.parse(localStorage.getItem(Ae)||"[]"),t=[];return e.forEach((function(e,n){e.id=n,t.push(p.fromJson(e))})),Be.uid=t.length,t}},Le=Be,Me={namespaced:!0,state:function(){return{houses:Le.fetchAll()}},getters:{findById:function(e){return function(t){return e.houses.find((function(e){return e.id===t}))}},findByInhabitant:function(e){return function(t){return e.houses.find((function(e){return e.inhabitants.indexOf(t)>=0}))}},exists:function(e,t){return function(e){return null!==t.findById(e)}},getSorted:function(e){return Object(Fe["a"])(e.houses).sort((function(e,t){return e.name.localeCompare(t.name)}))}},actions:{add:function(e,t){var n=t.name,i=t.beds;return new Promise((function(t){i=parseInt(i),n=n.trim();var s=new p(Le.uid++,n,i);return e.commit("create",s),t(s)}))},edit:function(e,t){var n=t.houseId,i=Object($e["a"])(t,["houseId"]);return new Promise((function(t,s){var a=e.getters.findById(n);return null===a?s("Could not find house in database"):(i.name&&(i.name=i.name.trim()),i.beds&&(i.beds=parseInt(i.beds)),e.commit("update",{house:a,payload:i}),t())}))},remove:function(e,t){return new Promise((function(n,i){var s=e.getters.findById(t);if(null===s)return i("Could not find house in database");var a=e.state.houses.indexOf(s);return e.commit("deleteAtIndex",a),n()}))},assignInhabitant:function(e,t){return Object(c["a"])(regeneratorRuntime.mark((function n(){var i,s,a,r;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(i=t.houseId,s=t.inhabitantId,a=e.getters.findById(i),a){n.next=4;break}throw new Error("Could not find house in database");case 4:if(!(a.inhabitants.length>=a.bedCount)){n.next=6;break}throw new Error("This house is full");case 6:if(!(a.inhabitants.indexOf(s)>=0)){n.next=8;break}return n.abrupt("return");case 8:if(r=e.getters.findByInhabitant(s),!r){n.next=13;break}if(r.id!==a.id){n.next=12;break}return n.abrupt("return");case 12:e.commit("deleteInhabitant",{house:r,inhabitantId:s});case 13:e.commit("addInhabitant",{house:a,inhabitantId:s});case 14:case"end":return n.stop()}}),n)})))()},removeInhabitant:function(e,t){return Object(c["a"])(regeneratorRuntime.mark((function n(){var i,s,a;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(i=t.houseId,s=t.inhabitantId,a=e.getters.findById(i),a){n.next=4;break}throw new Error("Could not find house in database");case 4:if(!(a.inhabitants.indexOf(s)<0)){n.next=6;break}return n.abrupt("return");case 6:e.commit("deleteInhabitant",{house:a,inhabitantId:s});case 7:case"end":return n.stop()}}),n)})))()}},mutations:{create:function(e,t){e.houses.push(t),Le.save(e.houses)},update:function(e,t){var n=t.house,i=t.payload,s=e.houses.indexOf(n);i.name&&(n.name=i.name),i.beds&&(n.bedCount=i.beds),e.houses[s]=n,Le.save(e.houses)},deleteAtIndex:function(e,t){e.houses.splice(t,1),Le.save(e.houses)},addInhabitant:function(e,t){var n=t.house,i=t.inhabitantId,s=e.houses.indexOf(n);n.inhabitants.push(i),e.houses[s]=n,Le.save(e.houses)},deleteInhabitant:function(e,t){var n=t.house,i=t.inhabitantId,s=e.houses.indexOf(n);n.inhabitants.splice(n.inhabitants.indexOf(i),1),e.houses[s]=n,Le.save(e.houses)}}};i["a"].use(Ne["a"]);var Re=new Ne["a"].Store({strict:!0,modules:{citizens:De,houses:Me}}),qe={inserted:function(e){e.focus()}};i["a"].directive("focus",qe),i["a"].config.productionTip=!1,new i["a"]({render:function(e){return e(He)},store:Re}).$mount("#app")},"70e2":function(e,t,n){"use strict";var i=n("db71"),s=n.n(i);s.a},"7d99":function(e,t,n){},"85ec":function(e,t,n){},ac87:function(e,t,n){"use strict";var i=n("cc14"),s=n.n(i);s.a},be87:function(e,t,n){},bfd2:function(e,t,n){},c02b:function(e,t,n){"use strict";var i=n("7d99"),s=n.n(i);s.a},cc14:function(e,t,n){},db71:function(e,t,n){},f3ff:function(e,t,n){"use strict";var i=n("0747"),s=n.n(i);s.a}});
//# sourceMappingURL=app.400acd2a.js.map